!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.PurifyHTML=t():e.PurifyHTML=t()}(globalThis,(()=>(()=>{"use strict";var e={};(e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(e);const t=(()=>{const e=(t,r=0)=>{if(t._d=r,!t.children.length)return r;[...t.children].forEach((t=>e(t,r+1)))};return t=>(e(t),[...t.querySelectorAll("*")].sort(((e,t)=>t._d-e._d)))})(),r=e=>{try{return new URL(e)}catch(e){return null}},s={"%correct-link%":e=>({remove:null===r(e)}),"%http-link%"(e){const t=r(e);return{remove:null===t||"http:"!==t.protocol}},"%https-link%"(e){const t=r(e);return{remove:null===t||"https:"!==t.protocol}},"%ftp-link%"(e){const t=r(e);return{remove:null===t||"ftp:"!==t.protocol}},"%https-link-without-search-params%"(e){const t=r(e);return{remove:null===t||""!==t.search||"https:"!==t.protocol}},"%http-link-without-search-params%"(e){const t=r(e);return{remove:null===t||""!==t.search||"http:"!==t.protocol}},"%same-origin%"(e){const t=r(e);return{remove:null===t||self.location.origin!==t.origin}}};let o={parse:e=>(new DOMParser).parseFromString(e,"text/html").querySelector("body"),stringify:e=>e.innerHTML};return self.PurifyHTML={sanitizer:class{constructor(e=[]){self.hasOwnProperty("structuredClone")?e=structuredClone(e):(console.warn(["\n",'The "self.structuredClone" method is not supported in this browser.',"This means that you cannot use regular expressions to validate attribute content.","You might consider using a polyfill from core-js: https://github.com/zloirock/core-js#structuredclone`","\n"].join("\n")),e=JSON.parse(JSON.stringify(e))),this.allowedTags=e.reduce(((e,t)=>{switch(typeof t){case"string":e[t]=Object.assign(e[t]||{},{});break;case"object":e[t.name]=Object.assign(e[t]||{},(e=>{const t=[];return e.hasOwnProperty("attributes")||(e.attributes=[]),e.attributes.forEach((e=>{switch(typeof e){case"string":t.push({name:e});break;case"object":t.push(e)}})),e.attributes=t,e})(t))}return e}),{}),this.whiteList=Object.keys(this.allowedTags),this.sanitize.bind(this)}sanitize(e){const r=o.parse(e);return t(r).forEach((e=>{const t=e.tagName.toLowerCase();if(this.whiteList.includes(t)){const r=this.allowedTags[t];if(r.hasOwnProperty("attributes")&&r.attributes.length>0){let t=[],o=[];for(let n=0;n<e.attributes.length;n++){const a=e.attributes[n],i=r.attributes.find((e=>e.name===a.name));i?i.hasOwnProperty("value")&&("string"==typeof i.value?a.value!==i.value&&o.push(a.name):i.value instanceof RegExp?i.value.test(a.value)||o.push(a.name):Array.isArray(i.value)?i.value.includes(a.value)||o.push(a.name):"object"==typeof i.value&&i.value.hasOwnProperty("preset")&&s.hasOwnProperty(i.value.preset)?s[i.value.preset](a.value).remove&&o.push(a.name):o.push(a.name)):t.push(a.name)}t.forEach((t=>e.removeAttribute(t))),o.forEach((t=>{return r=t,e.setAttribute(r,"");var r}))}else{const t=[];for(let r=0;r<e.attributes.length;r++)t.push(e.attributes[r].name);t.forEach((t=>e.removeAttribute(t)))}}else e.insertAdjacentHTML("afterend",e.innerHTML),e.remove()})),o.stringify(r)}toHTMLEntities(e){return e.split("").map((e=>`&#${e.charCodeAt()};`)).join("")}},setParser:e=>e.hasOwnProperty("parse")?e.hasOwnProperty("stringify")?(o=e,1):(console.error('cannot to find method "stringify" in custom parser!',e),0):(console.error('cannot to find method "parse" in custom parser!',e),0)},e})()));